---
title: é«˜ç²¾åº¦æ–æ³¢é‚£å¥‘çš„æ€§èƒ½æ·±æ¸Šï¼šFast Doubling ä¸ºä½•æ¯”çŸ©é˜µå¿«é€Ÿå¹‚å¿« 4 å€ï¼Ÿ
date: 2026-01-29
description: ä¸¥æ ¼æ¨å¯¼ Fast Doubling ä¸çŸ©é˜µå¿«é€Ÿå¹‚åœ¨å¤§æ•´æ•°è¾“å‡ºä¸‹çš„æ—¶é—´å¤æ‚åº¦ï¼Œè‡ªè¯å‡ ä½•çº§æ•°ä¸ç®—æœ¯-å‡ ä½•çº§æ•°æ±‚å’Œï¼Œæ­ç¤ºå¸¸æ•°å› å­å·®å¼‚çš„æ•°å­¦æ ¹æºã€‚
---
---

# ğŸ§—â€â™‚ï¸ çˆ¬æ¥¼æ¢¯é—®é¢˜å…¨è§£æï¼ˆä¸‹ï¼‰ï¼šFast Doubling ä¸ºä½•æ¯”çŸ©é˜µå¿«é€Ÿå¹‚æ›´å¿«ï¼Ÿ

> **å›é¡¾**ï¼šçˆ¬æ¥¼æ¢¯èµ°æ³•æ•° = $ F_{N+1} $ï¼Œå½“ $ N = 5000 $ æ—¶ï¼Œç»“æœæœ‰ **1046 ä½**ã€‚  
> æ­¤æ—¶ï¼Œæœ´ç´  DP çš„ $ O(N^2) $ æ—¶é—´å°šå¯æ¥å—ï¼›ä½†è‹¥ $ N = 10^6 $ï¼ŒDP éœ€çº¦ $ 10^{12} $ æ¬¡æ“ä½œâ€”â€”ä¸å¯è¡Œï¼  
> æˆ‘ä»¬éœ€è¦ **$ O(\log N) $ å±‚é€’å½’ + é«˜æ•ˆå¤§æ•°è¿ç®—** çš„æ–¹æ³•ã€‚

ä¸»æµå€™é€‰æœ‰ä¸¤ä¸ªï¼š
- **çŸ©é˜µå¿«é€Ÿå¹‚**
- **Fast Doublingï¼ˆå¿«é€Ÿå€å¢ï¼‰**

å¾ˆå¤šäººä»¥ä¸ºâ€œéƒ½æ˜¯ $ O(\log N) $â€ï¼Œå·®ä¸å¤šã€‚  
**ä½†äº‹å®æ˜¯ï¼šFast Doubling å¿« 3~4 å€ï¼** ä¸‹é¢æˆ‘ä»¬ä»æ•°å­¦åˆ°ç®—æ³•ï¼Œ**ä¸¥æ ¼æ¨å¯¼**è¿™ä¸€ç»“è®ºã€‚

---

## ğŸ”¢ ä¸€ã€æ–æ³¢é‚£å¥‘çš„é—­å¼ï¼šBinet å…¬å¼

### 1.1 ç‰¹å¾æ–¹ç¨‹
æ–æ³¢é‚£å¥‘æ»¡è¶³çº¿æ€§é€’æ¨ï¼š
$$
F_n = F_{n-1} + F_{n-2}
$$
å‡è®¾è§£ä¸ºæŒ‡æ•°å½¢å¼ $ F_n = r^n $ï¼Œä»£å…¥å¾—ï¼š
$$
r^n = r^{n-1} + r^{n-2} \Rightarrow r^2 = r + 1 \Rightarrow r^2 - r - 1 = 0
$$

### 1.2 æ±‚æ ¹
è§£å¾—ä¸¤ä¸ªå®æ ¹ï¼š
$$
\phi = \frac{1 + \sqrt{5}}{2},\quad \psi = \frac{1 - \sqrt{5}}{2}
$$
é€šè§£ä¸ºçº¿æ€§ç»„åˆï¼š
$$
F_n = A \phi^n + B \psi^n
$$

### 1.3 å®šç³»æ•°
ç”±åˆå§‹æ¡ä»¶ $ F_0 = 0, F_1 = 1 $ å¾—ï¼š
$$
\begin{cases}
A + B = 0 \\
A \phi + B \psi = 1
\end{cases}
\Rightarrow A = \frac{1}{\phi - \psi} = \frac{1}{\sqrt{5}},\quad B = -\frac{1}{\sqrt{5}}
$$

æ•…å¾—åˆ° **Binet å…¬å¼**ï¼š
$$
\boxed{F_n = \frac{\phi^n - \psi^n}{\sqrt{5}}}
$$

### 1.4 ä½æ•°ä¼°è®¡
ç”±äº $ |\psi| \approx 0.618 < 1 $ï¼Œå½“ $ n $ è¾ƒå¤§æ—¶ $ \psi^n \to 0 $ï¼Œå› æ­¤ï¼š
$$
F_n \approx \frac{\phi^n}{\sqrt{5}}
$$
å–åè¿›åˆ¶å¯¹æ•°ï¼š
$$
\log_{10} F_n \approx n \log_{10} \phi - \log_{10} \sqrt{5}
$$
å…¶ä¸­ $ \log_{10} \phi \approx 0.20899 $ï¼Œæ•… $ F_n $ çš„åè¿›åˆ¶ä½æ•°ï¼š
$$
L = \lfloor \log_{10} F_n \rfloor + 1 = \Theta(n)
$$

---

## âš™ï¸ äºŒã€å¤§æ•´æ•°ä¹˜æ³•ä»£ä»·æ¨¡å‹

åœ¨é«˜ç²¾åº¦è®¡ç®—ä¸­ï¼ŒåŠ /å‡æ³•ä»£ä»·ä¸º $ O(\ell) $ï¼Œè€Œä¹˜æ³•è¿œæ›´æ˜‚è´µã€‚  
ç°ä»£æœ€ä¼˜ç®—æ³•ï¼ˆå¦‚ SchÃ¶nhageâ€“Strassenï¼‰æ»¡è¶³ï¼š
$$
M(\ell) = c \cdot \ell \log \ell \quad (\ell \geq 2)
$$
å…¶ä¸­ $ c > 0 $ ä¸ºå¸¸æ•°ï¼Œå¯¹æ•°åº•æ•°ä¸å½±å“æ¸è¿‘ï¼ˆä»…å¸æ”¶åˆ° $ c $ ä¸­ï¼‰ã€‚

> ğŸ’¡ **ä¹˜æ³•æ˜¯æ€§èƒ½ç“¶é¢ˆ**ï¼Œåç»­åˆ†æèšç„¦äºä¹˜æ³•æ¬¡æ•°ã€‚

---

## ğŸ” ä¸‰ã€åˆ†æ²»ç»“æ„ä¸é€’å½’æ·±åº¦

ä¸¤ç§ç®—æ³•å‡é‡‡ç”¨åˆ†æ²»ç­–ç•¥ï¼Œé€’å½’æ·±åº¦ï¼š
$$
m = \lfloor \log_2 n \rfloor = \Theta(\log L)
$$
ç¬¬ $ i $ å±‚ï¼ˆ$ i = 0, 1, \dots, m-1 $ï¼‰å¤„ç†çš„æ•°å­—ä½é•¿ä¸ºï¼š
$$
\ell_i = \frac{L}{2^i}
$$
ï¼ˆå¿½ç•¥ä¸Šå–æ•´ï¼Œè¯¯å·®å¯å¸æ”¶åˆ°ä½é˜¶é¡¹ï¼‰

æ€»æ—¶é—´ä¸ºå„å±‚å¤§æ•´æ•°ä¹˜æ³•ä»£ä»·ä¹‹å’Œã€‚

---

## ğŸ“ å››ã€å…³é”®æ±‚å’Œå…¬å¼çš„ä¸¥æ ¼è¯æ˜

åœ¨è®¡ç®—æ€»æ—¶é—´æ—¶ï¼Œéœ€è¯„ä¼°ä»¥ä¸‹ä¸¤ä¸ªæœ‰é™å’Œã€‚

### 4.1 æœ‰é™å‡ ä½•çº§æ•°  
$$
A = \sum_{i=0}^{m-1} \left( \frac{1}{2} \right)^i
$$

**æ¨å¯¼**ï¼š  
ä»¤ $ x = \frac{1}{2} $ï¼Œåˆ™  
$$
A = \sum_{i=0}^{m-1} x^i
$$
ä¸¤è¾¹ä¹˜ $ x $ï¼š
$$
xA = \sum_{i=1}^{m} x^i
$$
ç›¸å‡ï¼š
$$
A - xA = 1 - x^m \Rightarrow A(1 - x) = 1 - x^m
\Rightarrow A = \frac{1 - x^m}{1 - x}
$$
ä»£å…¥ $ x = \frac{1}{2} $ï¼š
$$
A = \frac{1 - (1/2)^m}{1 - 1/2} = 2 \left(1 - \frac{1}{2^m} \right)
$$

âœ… å¾—è¯ï¼š
$$
\boxed{A = 2 \left(1 - \frac{1}{2^m} \right)}
$$

---

### 4.2 æœ‰é™ç®—æœ¯-å‡ ä½•çº§æ•°  
$$
B = \sum_{i=0}^{m-1} \frac{i}{2^i}
$$

ï¼ˆæ³¨æ„ï¼š$ i=0 $ é¡¹ä¸º 0ï¼Œå¯ä» $ i=1 $ å¼€å§‹ï¼‰

**æ¨å¯¼**ï¼š  
è€ƒè™‘ä¸€èˆ¬å½¢å¼ $ S = \sum_{i=1}^{k} i x^i $ã€‚  
å·²çŸ¥å‡ ä½•çº§æ•°ï¼š
$$
G(x) = \sum_{i=0}^{k} x^i = \frac{1 - x^{k+1}}{1 - x}
$$
å¯¹ $ x $ æ±‚å¯¼ï¼š
$$
G'(x) = \sum_{i=1}^{k} i x^{i-1} = \frac{d}{dx} \left( \frac{1 - x^{k+1}}{1 - x} \right)
$$
ç”¨å•†æ³•åˆ™è®¡ç®—å³è¾¹ï¼š
$$
G'(x) = \frac{ -(k+1)x^k (1 - x) + (1 - x^{k+1}) }{(1 - x)^2}
= \frac{1 - (k+1)x^k + k x^{k+1}}{(1 - x)^2}
$$
ä¸¤è¾¹ä¹˜ $ x $ å¾—ï¼š
$$
\sum_{i=1}^{k} i x^i = x \cdot \frac{1 - (k+1)x^k + k x^{k+1}}{(1 - x)^2}
$$

ä»¤ $ x = \frac{1}{2} $, $ k = m - 1 $ï¼š
- $ 1 - x = \frac{1}{2} \Rightarrow (1 - x)^2 = \frac{1}{4} $
- åˆ†å­ï¼š
  $$
  1 - (k+1)\left(\frac{1}{2}\right)^k + k \left(\frac{1}{2}\right)^{k+1}
  = 1 - \frac{k+1}{2^k} + \frac{k}{2^{k+1}}
  = 1 - \frac{2(k+1) - k}{2^{k+1}} = 1 - \frac{k + 2}{2^{k+1}}
  $$
- æ•´ä½“ï¼š
  $$
  S = \frac{1}{2} \cdot \frac{1 - \frac{k+2}{2^{k+1}}}{1/4}
  = 2 \left(1 - \frac{k+2}{2^{k+1}} \right)
  $$

ä»£å…¥ $ k = m - 1 $ â‡’ $ k + 2 = m + 1 $, $ 2^{k+1} = 2^m $ï¼š
$$
B = S = 2 \left(1 - \frac{m + 1}{2^m} \right) = 2 - \frac{2(m + 1)}{2^m} = 2 - \frac{m + 1}{2^{m - 1}}
$$

âœ… å¾—è¯ï¼š
$$
\boxed{B = 2 - \frac{m + 1}{2^{m - 1}}}
$$

---

## âš¡ äº”ã€Fast Doubling çš„ä¸¥æ ¼æ—¶é—´æ¨å¯¼

Fast Doubling åˆ©ç”¨æ’ç­‰å¼ï¼š
$$
F_{2k} = F_k (2F_{k+1} - F_k),\quad F_{2k+1} = F_{k+1}^2 + F_k^2
$$
æ¯å±‚éœ€ **2 æ¬¡å¤§æ•´æ•°ä¹˜æ³•**ï¼ˆä¸¤æ¬¡å¹³æ–¹ï¼‰ã€‚

æ€»æ—¶é—´ï¼š
$$
T_{\text{fd}} = \sum_{i=0}^{m-1} 2 \cdot M(\ell_i)
= 2c \sum_{i=0}^{m-1} \frac{L}{2^i} \log\left( \frac{L}{2^i} \right)
= 2cL \sum_{i=0}^{m-1} \frac{1}{2^i} (\log L - i)
= 2cL (\log L \cdot A - B)
$$

ä»£å…¥ $ A $ å’Œ $ B $ï¼š
$$
\begin{aligned}
T_{\text{fd}} &= 2cL \left[ \log L \cdot 2\left(1 - \frac{1}{2^m}\right) - \left(2 - \frac{m + 1}{2^{m - 1}}\right) \right] \\
&= 2cL \left[ 2\log L - \frac{2\log L}{2^m} - 2 + \frac{2(m + 1)}{2^m} \right] \\
&= 4cL(\log L - 1) + \frac{4cL}{2^m}(m + 1 - \log L)
\end{aligned}
$$

ç”±äº $ 2^m \leq n < 2^{m+1} $ ä¸” $ L = \Theta(n) $ï¼Œæœ‰ $ \frac{L}{2^m} = \Theta(1) $ï¼Œä¸” $ |m + 1 - \log L| = O(\log L) $ï¼Œæ•…ä½™é¡¹ä¸º $ O(\log L) $ã€‚

âœ… **æœ€ç»ˆç»“æœ**ï¼š
$$
\boxed{T_{\text{fd}} = 4cL(\log L - 1) + O(\log L)}
$$

---

## ğŸ§± å…­ã€çŸ©é˜µå¿«é€Ÿå¹‚çš„ä¸¥æ ¼æ—¶é—´æ¨å¯¼

çŸ©é˜µå¿«é€Ÿå¹‚æ¯å±‚æ‰§è¡Œ 2Ã—2 çŸ©é˜µä¹˜æ³•ï¼Œéœ€ **8 æ¬¡å¤§æ•´æ•°ä¹˜æ³•**ã€‚

æ€»æ—¶é—´ï¼š
$$
T_{\text{mat}} = \sum_{i=0}^{m-1} 8 \cdot M(\ell_i) = 4 \cdot T_{\text{fd}}
$$

âœ… **æœ€ç»ˆç»“æœ**ï¼š
$$
\boxed{T_{\text{mat}} = 16cL(\log L - 1) + O(\log L)}
$$

---

## âš–ï¸ ä¸ƒã€ä¸¥æ ¼æ¯”è¾ƒ

- ä¸¤è€…å‡ä¸º $ \Theta(L \log L) $
- ä½†å¸¸æ•°å› å­ä¹‹æ¯”ï¼š
  $$
  \frac{T_{\text{mat}}}{T_{\text{fd}}} = \frac{16cL(\log L - 1) + O(\log L)}{4cL(\log L - 1) + O(\log L)} = 4 + o(1)
  $$
- å³ï¼š**Fast Doubling çš„è¿è¡Œæ—¶é—´æ¸è¿‘ä¸ºçŸ©é˜µå¿«é€Ÿå¹‚çš„ 1/4**

---

## âœ… å…«ã€å·¥ç¨‹å»ºè®®

| åœºæ™¯ | æ¨èæ–¹æ³• |
|------|--------|
| $ N \leq 10^4 $ | æœ´ç´  DPï¼ˆç®€å•ã€ç¨³å®šï¼‰|
| $ N > 10^4 $ï¼Œéœ€å®Œæ•´è¾“å‡º | **Fast Doubling + é«˜ç²¾åº¦åº“** âœ… |
| ä»»ä½• $ N $ï¼Œåªéœ€å–æ¨¡ | çŸ©é˜µå¿«é€Ÿå¹‚ + æ¨¡è¿ç®— âœ… |

---
